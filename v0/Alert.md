# Alert

### Create an Alert with an Observable (via API)

```json
{
    "_id": "~57496",
    "_type": "audit",
    "base": true,
    "context": {
        "_id": "~40993016",
        "_type": "alert",
        "artifacts": [],
        "case": null,
        "caseTemplate": null,
        "createdAt": 1683378066188,
        "createdBy": "user@thehive.local",
        "customFieldValues": {},
        "customFields": {},
        "date": 1683378066000,
        "description": "Hello world",
        "externalLink": null,
        "follow": true,
        "id": "~40993016",
        "pap": 1,
        "severity": 1,
        "similarCases": [],
        "source": "API",
        "sourceRef": "API_1",
        "stage": "New",
        "status": "New",
        "tags": [],
        "title": "TestAlert1",
        "tlp": 1,
        "type": "API",
        "updatedAt": 1683378066250,
        "updatedBy": "user@thehive.local"
    },
    "createdAt": 1683378066274,
    "createdBy": "user@thehive.local",
    "details": {
        "_createdAt": 1683378066188,
        "_createdBy": "user@thehive.local",
        "_id": "~40993016",
        "_type": "Alert",
        "customFields": {},
        "date": 1683378066000,
        "description": "Hello world",
        "extraData": {},
        "follow": true,
        "newDate": 1683378066166,
        "observableCount": 0,
        "pap": 1,
        "severity": 1,
        "source": "API",
        "sourceRef": "API_1",
        "stage": "New",
        "status": "New",
        "tags": [],
        "timeToDetect": 0,
        "title": "TestAlert1",
        "tlp": 1,
        "type": "API"
    },
    "id": "~57496",
    "object": {
        "_id": "~40993016",
        "_type": "alert",
        "artifacts": [],
        "case": null,
        "caseTemplate": null,
        "createdAt": 1683378066188,
        "createdBy": "user@thehive.local",
        "customFieldValues": {},
        "customFields": {},
        "date": 1683378066000,
        "description": "Hello world",
        "externalLink": null,
        "follow": true,
        "id": "~40993016",
        "pap": 1,
        "severity": 1,
        "similarCases": [],
        "source": "API",
        "sourceRef": "API_1",
        "stage": "New",
        "status": "New",
        "tags": [],
        "title": "TestAlert1",
        "tlp": 1,
        "type": "API",
        "updatedAt": 1683378066250,
        "updatedBy": "user@thehive.local"
    },
    "objectId": "~40993016",
    "objectType": "alert",
    "operation": "Creation",
    "organisation": {
        "organisation": "sample-org",
        "organisationId": "~40964176"
    },
    "requestId": "fe83537a8ffa36d3:18887829:187efcf369e:-8000:1265",
    "rootId": "~40993016",
    "startDate": 1683378066893
}
```

```json
{
    "_id": "",
    "_type": "audit",
    "base": false,
    "context": {
        "_id": "~40993016",
        "_type": "alert",
        "artifacts": [],
        "case": null,
        "caseTemplate": null,
        "createdAt": 1683378066188,
        "createdBy": "user@thehive.local",
        "customFieldValues": {},
        "customFields": {},
        "date": 1683378066000,
        "description": "Hello world",
        "externalLink": null,
        "follow": true,
        "id": "~40993016",
        "pap": 1,
        "severity": 1,
        "similarCases": [],
        "source": "API",
        "sourceRef": "API_1",
        "stage": "New",
        "status": "New",
        "tags": [],
        "title": "TestAlert1",
        "tlp": 1,
        "type": "API",
        "updatedAt": 1683378066250,
        "updatedBy": "user@thehive.local"
    },
    "createdAt": 1683378067139,
    "createdBy": "user@thehive.local",
    "details": {
        "_createdAt": 1683378066243,
        "_createdBy": "user@thehive.local",
        "_id": "~40993000",
        "_type": "Observable",
        "data": "1.1.1.1",
        "dataType": "ip",
        "extraData": {},
        "ignoreSimilarity": false,
        "ioc": false,
        "message": "maybe bad",
        "pap": 2,
        "reports": {},
        "sighted": false,
        "startDate": 1683378066243,
        "tags": [
            "destination-ip"
        ],
        "tlp": 0
    },
    "id": "",
    "object": {
        "_id": "~40993000",
        "_type": "case_artifact",
        "alert": {
            "_id": "~40993016",
            "_type": "alert",
            "artifacts": [],
            "case": null,
            "caseTemplate": null,
            "createdAt": 1683378066188,
            "createdBy": "user@thehive.local",
            "customFieldValues": {},
            "customFields": {},
            "date": 1683378066000,
            "description": "Hello world",
            "externalLink": null,
            "follow": true,
            "id": "~40993016",
            "pap": 1,
            "severity": 1,
            "similarCases": [],
            "source": "API",
            "sourceRef": "API_1",
            "stage": "New",
            "status": "New",
            "tags": [],
            "title": "TestAlert1",
            "tlp": 1,
            "type": "API",
            "updatedAt": 1683378066250,
            "updatedBy": "user@thehive.local"
        },
        "createdAt": 1683378066243,
        "createdBy": "user@thehive.local",
        "data": "1.1.1.1",
        "dataType": "ip",
        "id": "~40993000",
        "ignoreSimilarity": false,
        "ioc": false,
        "message": "maybe bad",
        "pap": 2,
        "reports": {},
        "sighted": false,
        "startDate": 1683378066243,
        "stats": {},
        "tags": [
            "destination-ip"
        ],
        "tlp": 0
    },
    "objectId": "~40993000",
    "objectType": "case_artifact",
    "operation": "Creation",
    "organisation": {
        "organisation": "sample-org",
        "organisationId": "~40964176"
    },
    "requestId": "fe83537a8ffa36d3:18887829:187efcf369e:-8000:1265",
    "rootId": "~40993016",
    "startDate": 1683378067139
}
```

---

### Add an Observable to an existing Alert (via API)

```json
{
    "_id": "~40997096",
    "_type": "audit",
    "base": true,
    "context": {
        "_id": "~40993016",
        "_type": "alert",
        "artifacts": [],
        "case": null,
        "caseTemplate": null,
        "createdAt": 1683378066188,
        "createdBy": "user@thehive.local",
        "customFieldValues": {},
        "customFields": {},
        "date": 1683378066000,
        "description": "Hello world",
        "externalLink": null,
        "follow": true,
        "id": "~40993016",
        "pap": 1,
        "severity": 1,
        "similarCases": [],
        "source": "API",
        "sourceRef": "API_1",
        "stage": "New",
        "status": "New",
        "tags": [],
        "title": "TestAlert1",
        "tlp": 1,
        "type": "API",
        "updatedAt": 1683378434862,
        "updatedBy": "user@thehive.local"
    },
    "createdAt": 1683378434866,
    "createdBy": "user@thehive.local",
    "details": {
        "_createdAt": 1683378434859,
        "_createdBy": "user@thehive.local",
        "_id": "~40984624",
        "_type": "Observable",
        "data": "1.1.1.2",
        "dataType": "ip",
        "extraData": {},
        "ignoreSimilarity": false,
        "ioc": false,
        "message": "maybe bad",
        "pap": 2,
        "reports": {},
        "sighted": false,
        "startDate": 1683378434859,
        "tags": [
            "destination-ip"
        ],
        "tlp": 0
    },
    "id": "~40997096",
    "object": {
        "_id": "~40984624",
        "_type": "case_artifact",
        "alert": {
            "_id": "~40993016",
            "_type": "alert",
            "artifacts": [],
            "case": null,
            "caseTemplate": null,
            "createdAt": 1683378066188,
            "createdBy": "user@thehive.local",
            "customFieldValues": {},
            "customFields": {},
            "date": 1683378066000,
            "description": "Hello world",
            "externalLink": null,
            "follow": true,
            "id": "~40993016",
            "pap": 1,
            "severity": 1,
            "similarCases": [],
            "source": "API",
            "sourceRef": "API_1",
            "stage": "New",
            "status": "New",
            "tags": [],
            "title": "TestAlert1",
            "tlp": 1,
            "type": "API",
            "updatedAt": 1683378434862,
            "updatedBy": "user@thehive.local"
        },
        "createdAt": 1683378434859,
        "createdBy": "user@thehive.local",
        "data": "1.1.1.2",
        "dataType": "ip",
        "id": "~40984624",
        "ignoreSimilarity": false,
        "ioc": false,
        "message": "maybe bad",
        "pap": 2,
        "reports": {},
        "sighted": false,
        "startDate": 1683378434859,
        "stats": {},
        "tags": [
            "destination-ip"
        ],
        "tlp": 0
    },
    "objectId": "~40984624",
    "objectType": "case_artifact",
    "operation": "Creation",
    "organisation": {
        "organisation": "sample-org",
        "organisationId": "~40964176"
    },
    "requestId": "fe83537a8ffa36d3:18887829:187efcf369e:-8000:1326",
    "rootId": "~40993016",
    "startDate": 1683378436027
}
```

---

### Start an Alert

```json
{
    "_id": "~40988720",
    "_type": "audit",
    "base": true,
    "context": {
        "_id": "~40993016",
        "_type": "alert",
        "artifacts": [],
        "case": null,
        "caseTemplate": null,
        "createdAt": 1683378066188,
        "createdBy": "user@thehive.local",
        "customFieldValues": {},
        "customFields": {},
        "date": 1683378066000,
        "description": "Hello world",
        "externalLink": null,
        "follow": true,
        "id": "~40993016",
        "pap": 1,
        "severity": 1,
        "similarCases": [],
        "source": "API",
        "sourceRef": "API_1",
        "stage": "InProgress",
        "status": "Updated",
        "tags": [],
        "title": "TestAlert1",
        "tlp": 1,
        "type": "API",
        "updatedAt": 1683378632635,
        "updatedBy": "user@thehive.local"
    },
    "createdAt": 1683378632644,
    "createdBy": "user@thehive.local",
    "details": {
        "stage": "InProgress",
        "status": "InProgress",
        "summary": ""
    },
    "id": "~40988720",
    "object": {
        "_id": "~40993016",
        "_type": "alert",
        "artifacts": [],
        "case": null,
        "caseTemplate": null,
        "createdAt": 1683378066188,
        "createdBy": "user@thehive.local",
        "customFieldValues": {},
        "customFields": {},
        "date": 1683378066000,
        "description": "Hello world",
        "externalLink": null,
        "follow": true,
        "id": "~40993016",
        "pap": 1,
        "severity": 1,
        "similarCases": [],
        "source": "API",
        "sourceRef": "API_1",
        "stage": "InProgress",
        "status": "Updated",
        "tags": [],
        "title": "TestAlert1",
        "tlp": 1,
        "type": "API",
        "updatedAt": 1683378632635,
        "updatedBy": "user@thehive.local"
    },
    "objectId": "~40993016",
    "objectType": "alert",
    "operation": "Update",
    "organisation": {
        "organisation": "sample-org",
        "organisationId": "~40964176"
    },
    "requestId": "fe83537a8ffa36d3:18887829:187efcf369e:-8000:1347",
    "rootId": "~40993016",
    "startDate": 1683378633075
}
```

---

### Close an Alert as Duplicate

```json
{
    "_id": "~28712",
    "_type": "audit",
    "base": true,
    "context": {
        "_id": "~40993016",
        "_type": "alert",
        "artifacts": [],
        "case": null,
        "caseTemplate": null,
        "createdAt": 1683378066188,
        "createdBy": "user@thehive.local",
        "customFieldValues": {},
        "customFields": {},
        "date": 1683378066000,
        "description": "Hello world",
        "externalLink": null,
        "follow": true,
        "id": "~40993016",
        "pap": 1,
        "severity": 1,
        "similarCases": [],
        "source": "API",
        "sourceRef": "API_1",
        "stage": "Closed",
        "status": "Ignored",
        "tags": [],
        "title": "TestAlert1",
        "tlp": 1,
        "type": "API",
        "updatedAt": 1683378744388,
        "updatedBy": "user@thehive.local"
    },
    "createdAt": 1683378744394,
    "createdBy": "user@thehive.local",
    "details": {
        "stage": "Closed",
        "status": "Duplicate",
        "summary": ""
    },
    "id": "~28712",
    "object": {
        "_id": "~40993016",
        "_type": "alert",
        "artifacts": [],
        "case": null,
        "caseTemplate": null,
        "createdAt": 1683378066188,
        "createdBy": "user@thehive.local",
        "customFieldValues": {},
        "customFields": {},
        "date": 1683378066000,
        "description": "Hello world",
        "externalLink": null,
        "follow": true,
        "id": "~40993016",
        "pap": 1,
        "severity": 1,
        "similarCases": [],
        "source": "API",
        "sourceRef": "API_1",
        "stage": "Closed",
        "status": "Ignored",
        "tags": [],
        "title": "TestAlert1",
        "tlp": 1,
        "type": "API",
        "updatedAt": 1683378744388,
        "updatedBy": "user@thehive.local"
    },
    "objectId": "~40993016",
    "objectType": "alert",
    "operation": "Update",
    "organisation": {
        "organisation": "sample-org",
        "organisationId": "~40964176"
    },
    "requestId": "fe83537a8ffa36d3:18887829:187efcf369e:-8000:1414",
    "rootId": "~40993016",
    "startDate": 1683378745192
}
```

---

### Delete an Alert

```json
{
    "_id": "~41001192",
    "_type": "audit",
    "base": true,
    "context": {
        "_id": "~40964176",
        "_type": "organisation",
        "createdAt": 1683223840663,
        "createdBy": "admin@thehive.local",
        "description": "sample-org",
        "id": "~40964176",
        "links": [],
        "locked": false,
        "name": "sample-org",
        "observableRule": "manual",
        "taskRule": "manual"
    },
    "createdAt": 1683378856805,
    "createdBy": "user@thehive.local",
    "details": {},
    "id": "~41001192",
    "objectId": "~40993016",
    "objectType": "alert",
    "operation": "Delete",
    "organisation": {
        "organisation": "sample-org",
        "organisationId": "~40964176"
    },
    "requestId": "fe83537a8ffa36d3:18887829:187efcf369e:-8000:1423",
    "rootId": "~40964176",
    "startDate": 1683378857175
}
```
